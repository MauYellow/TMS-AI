<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <meta name="description" content="">
        <meta name="author" content="">

        <title>TMS AI</title>

        <!-- CSS FILES -->        
        <link rel="preconnect" href="https://fonts.googleapis.com">
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700&family=Open+Sans&display=swap" rel="stylesheet">
                        
        <link href="/static/css/bootstrap.min.css" rel="stylesheet">

        <link href="/static/css/bootstrap-icons.css" rel="stylesheet">

        <link href="/static/css/templatemo-topic-listing.css" rel="stylesheet">      

    </head>
    
    <body id="top">

        <style>
            body {
                padding-top: 56px; /* Adjust if your navbar is taller */
            }
            @media (max-width: 991.98px) {
                body {
                    padding-top: 0;
                }
            }
        </style>

        <main>

            <nav class="navbar navbar-expand-lg">
                <div class="container">
                    <a class="navbar-brand" href="index.html">
                        <img width="64" height="64" src="https://img.icons8.com/nolan/64/cursor-ai.png" alt="cursor-ai" />
                        <span>Rebecca AI</span>
                    </a>

                    <div class="d-lg-none ms-auto me-4">
                        <a href="#top" class="navbar-icon bi-person smoothscroll"></a>
                    </div>
    
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
    
                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav ms-lg-5 me-lg-auto">

                            <li class="nav-item">
                                <a class="nav-link click-scroll" href="/download-report">Unsolved Questions</a>
                            </li>
                            

                        </ul>

                        <div class="d-none d-lg-block">
                            <a href="#top" class="navbar-icon bi-person smoothscroll"></a>
                        </div>
                    </div>
                </div>
            </nav>
            

            <section class="py-5 bg-light">
                <div class="container">
                    <div class="row">
            
                        <!-- üî¥ Colonna Sinistra: Box AI Powered & Finance -->
                        <div class="col-lg-3 col-12 mb-4">
                            <p class="copyright-text text-center mt-lg-5 mt-4">Made with ‚ù§Ô∏è by <a
                                    href="https://www.linkedin.com/in/maurizio-polverini-food-and-beverage-manager/" target="_blank">Maurizio
                                    Polverini</a></p>
            
                            <div class="custom-block custom-block-overlay" style="height: 100px; overflow: hidden;">
                                <div class="d-flex flex-column h-100">
                                    <img src="/static/images/businesswoman-using-tablet-analysis.jpg"
                                        class="custom-block-image img-fluid" alt="">
                                    <div class="custom-block-overlay-text d-flex">
                                        <div>
                                            <h5 class="text-white mb-2">Free Tool</h5>
                                            <p class="text-white">Only use this service if really necessary. <br><br>‚ö†Ô∏è Don't ask stupid things or your account will be <span style="color: red;"><strong>blocked</strong></span>.</p>
                                        </div>
                                    </div>
                                    <div class="section-overlay"></div>
                                </div>
                            </div>
                            <div class="custom-block bg-white shadow-lg mb-4 p-3" style="height: 200px;">
                                <div class="d-flex flex-column justify-content-center align-items-center h-100 text-center">
                                    <h5 class="mb-3">Account Status</h5>
                                    <button class="btn btn-success btn-sm px-4" disabled>Active</button>
                                    <br>
                                    <p style="font-size: 0.8rem;">Prova questo √® un messaggio di prova</p>
                                </div>
                            </div>





                        </div>
            
                        <!-- üü¢ Colonna Destra: Dropdown + Search + Risposta AI -->
                        <div class="col-lg-9 col-12">
                            <h2 class="text-dark text-center mb-3">Internal Support for TMS</h2>
                                        
                            <!-- Dropdown -->
                            <div class="mb-3">
                                <select class="form-select form-select-lg" name="category" id="category">
                                    <option selected disabled style="background-color: #dffff9;">Please Choose Topic Category</option>
                                    <option value="2" style="background-color: #dffff9;">Account Management</option>
                                    <option value="4" style="background-color: #dffff9;">Control Room</option>
                                    <option value="5" style="background-color: #dffff9;">Fleet Management System</option>
                                    <option value="6" style="background-color: #dffff9;">AV Management System</option>
                                    <option value="7" style="background-color: #dffff9;">GIS & POIs</option>
                                    <option value="8" style="background-color: #dffff9;">Bus Management System</option>
                                    <option value="9" style="background-color: #dffff9;">Reports</option>
                                </select>
                            </div>
            
                            <!-- Search form -->
                            <form method="get" id="search-form" class="custom-form mb-4" role="search">
                                <div class="input-group input-group-lg rounded-pill overflow-hidden shadow-sm">
                                    <!-- Input -->
                                    <input name="keyword" type="search" class="form-control border-0" id="keyword" placeholder="Ask me anything..."
                                        aria-label="Search" style="border-radius: 0; padding: 15px 20px;">
                            
                                    <!-- Button -->
                                    <button type="submit"
                                        class="btn btn-primary d-flex flex-column align-items-center justify-content-center text-center"
                                        style="border-radius: 0 50px 50px 0; padding: 10px 25px; font-weight: 500; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                                        <span>Send Message</span>
                                        <small style="font-size: 0.7em; opacity: 0.8;">or click "Enter"</small>
                                    </button>
                                </div>
                            </form>


                            
        
                            <!-- AI Response box -->
                            <div id="ai-response-box" class="custom-block bg-white shadow-lg p-4" style="max-height: 400px; overflow-y: auto;">
                                <h5 class="mb-3">AI Response</h5>
                                <p class="text-muted mb-0" style="font-size: 1.1rem; font-family: 'Open Sans', sans-serif;">
                                    The AI response will appear here after your question is submitted.
                                </p>
                            </div>
                            

                        </div>
            
                    </div>
                </div>
            </section>
        </main>



        <!-- JAVASCRIPT FILES -->
        <script src="/static/js/jquery.min.js"></script>
        <script src="/static/js/bootstrap.bundle.min.js"></script>
        <script src="/static/js/jquery.sticky.js"></script>
        <script src="/static/js/click-scroll.js"></script>
        <script src="/static/js/custom.js"></script>

        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const form = document.getElementById("search-form");
                const keywordInput = document.getElementById("keyword");
                const responseBox = document.getElementById("ai-response-box");
                const categorySelect = document.getElementById("category");

                if (!form || !keywordInput || !responseBox || !categorySelect) {
                    console.error("Form o elementi mancanti!");
                    return;
                }

                form.addEventListener("submit", async function (e) {
                    e.preventDefault();
                    const keyword = keywordInput.value.trim();
                    const category = categorySelect.value;

                    if (!keyword || !category || category === "Please Choose Topic Category") {
                        responseBox.innerHTML = "<p class='text-warning'>Please select a valid category and enter a question.</p>";
                        return;
                    }

                    responseBox.innerHTML = "<p class='text-muted'>Loading...</p>";

                    try {
                        const response = await fetch("/ask", {
                            method: "POST",
                            headers: { "Content-Type": "application/json" },
                            body: JSON.stringify({ question: keyword, category: category }),
                        });

                        const data = await response.json();
                        responseBox.innerHTML = `<pre style="font-size: 1.1rem; font-family: 'Open Sans', sans-serif; white-space: pre-wrap;">${data.answer}</pre>`;
                    } catch (err) {
                        responseBox.innerHTML = `<p class='text-danger'>Errore: ${err.message}</p>`;
                        console.error(err);
                    }
                });
            });
        </script>
    </body>
</html>
